{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pickle\n",
    "import time\n",
    "import numpy as np\n",
    "#from scipy import signal\n",
    "import matplotlib.pyplot as plt\n",
    "#import connectivity_measures as cm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "IDs = ['SERT1597', 'SERT1659', 'SERT1678', 'SERT1908',\n",
    "       'SERT1984', 'SERT1985', 'SERT2014', 'SERT1668',\n",
    "       'SERT1665', 'SERT2018', 'SERT2024', 'SERT2013']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Loading mouse SERT1597...\n",
      "\n",
      "Loading mouse SERT1659...\n",
      "\n",
      "Loading mouse SERT1678...\n",
      "\n",
      "Loading mouse SERT1908...\n",
      "\n",
      "Loading mouse SERT1984...\n",
      "\n",
      "Loading mouse SERT1985...\n",
      "\n",
      "Loading mouse SERT2014...\n",
      "\n",
      "Loading mouse SERT1668...\n",
      "\n",
      "Loading mouse SERT1665...\n",
      "\n",
      "Loading mouse SERT2018...\n",
      "\n",
      "Loading mouse SERT2024...\n",
      "\n",
      "Loading mouse SERT2013...\n",
      "Done!\n"
     ]
    }
   ],
   "source": [
    "#iCoh = dict()\n",
    "iteration = 0\n",
    "for mouse in IDs: \n",
    "    npys_dir = '/home/maspe/filer/SERT/' + mouse + '/npys/'\n",
    "    print('\\nLoading mouse {}...'.format(mouse))\n",
    "    \n",
    "    ### Loading data\n",
    "    data = pickle.load(open(npys_dir + mouse + '.icoh', 'rb')) #, encoding='latin1')\n",
    "    \n",
    "    pre_post = dict()\n",
    "    for band in ['theta', 'low_gamma']:\n",
    "        if len(data[band]['pre'].shape) > 2: \n",
    "            pre = np.mean(data[band]['pre'], axis=2)\n",
    "            post = np.mean(data[band]['post'], axis=2)\n",
    "        else:\n",
    "            pre = data[band]['pre']\n",
    "            post = data[band]['post']\n",
    "        \n",
    "        pre_post[band] = post\n",
    "        i_lower  = np.tril_indices(post.shape[0], 0)\n",
    "        pre_post[band][i_lower] = pre.T[i_lower] \n",
    "        \n",
    "        \n",
    "    if iteration == 0:\n",
    "        theta_grandAverage     = pre_post['theta']\n",
    "        low_gamma_grandAverage = pre_post['low_gamma']\n",
    "    else:\n",
    "        theta_grandAverage     = np.dstack((theta_grandAverage, pre_post['theta']))\n",
    "        low_gamma_grandAverage = np.dstack((low_gamma_grandAverage, pre_post['low_gamma']))\n",
    "        \n",
    "    iteration += 1\n",
    "\n",
    "        \n",
    "print('Done!')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Theta band"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.colorbar.Colorbar at 0x7f68b305c150>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 5400x5400 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 288x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(75,75))\n",
    "\n",
    "plt.matshow(np.mean(theta_grandAverage, axis=2))\n",
    "plt.plot(np.arange(0,32), color='black', linewidth=2)\n",
    "\n",
    "for line_pos in [10,16,23]:\n",
    "    plt.axvline(x=line_pos, color='white', linewidth=0.5)\n",
    "    plt.axhline(y=line_pos, color='white', linewidth=0.5)\n",
    "\n",
    "plt.xticks([5,13,20,27], ['mPFC', 'NAC', 'BLA', 'vHip'], rotation=0, fontsize=14)\n",
    "plt.yticks([5,13,20,27], ['mPFC', 'NAC', 'BLA', 'vHip'], rotation=0, fontsize=14)\n",
    "\n",
    "plt.text(6,24,'PRE', fontsize=18)\n",
    "plt.text(18,8,'POST', fontsize=18)\n",
    "\n",
    "plt.colorbar()\n",
    "#plt.savefig(allFigs_dir + 'lgamma_synchrony_WT.pdf', dpi=150, format='pdf')\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Phase lag index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "data = theta_WT\n",
    "z = signal.hilbert(data)\n",
    "phases = np.angle(z)\n",
    "#z_NAC = signal.hilbert(NAC)\n",
    "#z_BLA = signal.hilbert(BLA)\n",
    "#z_vHip = signal.hilbert(vHip)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "phases.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "window = 1500\n",
    "\n",
    "# pre_icoh  = np.zeros((32,32))\n",
    "# post_icoh = np.zeros((32,32))\n",
    "\n",
    "data = phases\n",
    "for mouse in range(data.shape[2]):\n",
    "    \n",
    "    if mouse == 0:\n",
    "        pre_wpli  = cm.PLI2(data[:, 2000:3000, mouse], average = False)\n",
    "        post_wpli  = cm.PLI2(data[:, 3000:5000+window, mouse], average = False)\n",
    "        \n",
    "    else:\n",
    "        pre_wpli  = np.dstack((pre_wpli, cm.PLI2(data[:, 2000:3000, mouse], average = False)))\n",
    "        post_wpli = np.dstack((post_wpli, cm.PLI2(data[:, 3000:5000, mouse], average = False)))\n",
    "        "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "pre_wpli.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "pre_wpli_all  = np.mean(pre_wpli, axis=2)\n",
    "post_wpli_all = np.mean(post_wpli, axis=2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.figure(figsize=(150,150))\n",
    "plt.matshow(pre_wpli_all)\n",
    "#plt.xticks(ticks=np.arange(0, 32, 8), labels=['OFC', 'mPFC', 'DMS', 'BLA'], rotation=0)\n",
    "#plt.yticks(ticks=np.arange(0, 32, 8), labels=['OFC', 'mPFC', 'DMS', 'BLA'], rotation=0)\n",
    "plt.colorbar()\n",
    "# plt.savefig(mydir + 'prePLI.png', dpi=150, format='png')\n",
    "\n",
    "plt.figure(figsize=(150,150))\n",
    "plt.matshow(post_wpli_all)\n",
    "#plt.xticks(ticks=np.arange(0, 32, 8), labels=['OFC', 'mPFC', 'DMS', 'BLA'], rotation=0)\n",
    "#plt.yticks(ticks=np.arange(0, 32, 8), labels=['OFC', 'mPFC', 'DMS', 'BLA'], rotation=0)\n",
    "plt.colorbar()\n",
    "# plt.savefig(mydir + 'postPLI.png', dpi=150, format='png')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###################################"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Band-pass signal and plot power spectral density"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "files = sorted(glob.glob(\"/home/maspe/filer/testMice/CC1973/HC_2018-04-24_16-56-27/*.continuous\"))\n",
    "channel = ps.loadContinuous(files[10])\n",
    "data = channel['data']\n",
    "sampleRate = channel['header']['sampleRate']\n",
    "sampleRate"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def butter_bandpass(lowcut, highcut, fs, order=5):\n",
    "    nyq = 0.5 * fs\n",
    "    low = lowcut / nyq\n",
    "    high = highcut / nyq\n",
    "    b, a = signal.butter(order, [low, high], btype='band')\n",
    "    return b, a\n",
    "\n",
    "N       = 2\n",
    "fs      = sampleRate\n",
    "lowcut  = 4.0\n",
    "highcut = 12.0\n",
    "\n",
    "b, a = butter_bandpass(lowcut, highcut, fs, order=N)\n",
    "\n",
    "theta_band = signal.filtfilt(b=b, a=a, x=data - np.mean(data),\n",
    "                           axis=-1, padtype='odd', padlen=None, method='pad', irlen=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "theta_band.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "fig = plt.figure()\n",
    "plt.subplot(2,1,1)\n",
    "plt.plot(data[10000:40000])\n",
    "plt.subplot(2,1,2)\n",
    "plt.plot(theta_band[10000:40000])\n",
    "\n",
    "fig.savefig(\"/home/maspe/filer/testFiles/figs/theta.png\", dpi=150, format='png')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "freqs = np.fft.fftfreq(len(data), sampleRate)\n",
    "\n",
    "plt.plot(freqs[0:len(data)//2],2/len(data)*np.abs(theta_band[0:len(data)//2]))\n",
    "plt.xlim([0,10])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "z = signal.hilbert(theta_band) #form the analytical signal\n",
    "z"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "inst_phase = np.unwrap(np.angle(z))\n",
    "inst_phase"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.polar(z.real[:1000], z.imag[:1000], 'ro')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "f, psd = signal.welch(theta_band, fs=30000, window='hann', nperseg=None, noverlap=None, nfft=None,\n",
    "                      detrend='constant', return_onesided=True, scaling='density', axis=-1, average='mean')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Plot the power spectrum\n",
    "plt.figure(figsize=(11,3))\n",
    "plt.semilogy(f,psd,'k')\n",
    "# sns.despine()\n",
    "plt.xlim((0,100))\n",
    "plt.yticks(size=15)\n",
    "plt.xticks(size=15)\n",
    "plt.ylabel('power ($uV^{2}/Hz$)',size=15)\n",
    "plt.xlabel('frequency (Hz)',size=15)\n",
    "plt.title('PSD of Local Field Potential', size=20)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# def butter_bandpass(lowcut, highcut, fs, order):\n",
    "#     nyq = 0.5 * fs\n",
    "#     low = lowcut / nyq\n",
    "#     high = highcut / nyq\n",
    "#     b, a = signal.butter(order, [low, high], btype='bandpass')\n",
    "#     return b, a\n",
    "\n",
    "# [b, a] = butter_bandpass(lowcut = 4, highcut = 8, fs = 30000.0, order = 3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "matrix_KO = post_icoh_KO\n",
    "matrix_KO[1,0] = pre_icoh_KO[1,0]\n",
    "matrix_KO[2,0] = pre_icoh_KO[2,0]\n",
    "matrix_KO[3,0] = pre_icoh_KO[3,0]\n",
    "matrix_KO[2,1] = pre_icoh_KO[2,1]\n",
    "matrix_KO[3,1] = pre_icoh_KO[3,1]\n",
    "matrix_KO[3,2] = pre_icoh_KO[3,2]"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.17"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
